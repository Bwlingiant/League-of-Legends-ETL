CREATE OR REPLACE VIEW "YRDEN".LEAGUE_CHALLENGES AS
SELECT YP.RIOT_PUUID,
YP.RIOT_ID,
LCT.CHALLENGE_ID,
LCV.NAME,
LCT.VALUE,
-- LMAO THIS SUCKS SHIT NEED TO COME BACK AND FIX IT LATER
CASE
WHEN LCT.VALUE < LCV.IRON
THEN LCV.IRON - LCT.VALUE
WHEN LCT.VALUE < LCV.BRONZE
THEN LCV.BRONZE - LCT.VALUE
WHEN LCT.VALUE < LCV.SILVER
THEN LCV.SILVER - LCT.VALUE
WHEN LCT.VALUE < LCV.GOLD
THEN LCV.GOLD - LCT.VALUE
WHEN LCT.VALUE < LCV.PLATINUM
THEN LCV.PLATINUM - LCT.VALUE
WHEN LCT.VALUE < LCV.DIAMOND
THEN LCV.DIAMOND - LCT.VALUE
WHEN LCT.VALUE < LCV.MASTER
THEN LCV.MASTER - LCT.VALUE
WHEN LCT.VALUE < LCV.GRANDMASTER
THEN LCV.GRANDMASTER - LCT.VALUE
WHEN LCT.VALUE < LCV.CHALLENGER
THEN LCV.CHALLENGER - LCT.VALUE
ELSE 0
END AS POINTS_NEEDED,
LCT.CHALLENGE_LEVEL, LCT.ACHIEVED_TIME, LCT.PERCENTILE,
LCV.TIER, LCV.SHORTDESCRIPTION,
LCV.IRON, LCV.BRONZE, LCV.SILVER, LCV.GOLD, LCV.PLATINUM, LCV.DIAMOND, LCV.MASTER, LCV.GRANDMASTER, LCV.CHALLENGER
FROM "YRDEN".LOL_CHALLENGES LCT
LEFT JOIN "YRDEN".YRDEN_PEOPLE YP
ON LCT.PUUID = YP.RIOT_PUUID
LEFT JOIN "LOLLOV".LOL_CHALLENGES LCV
ON LCT.CHALLENGE_ID = LCV.CHALLENGE_ID
;