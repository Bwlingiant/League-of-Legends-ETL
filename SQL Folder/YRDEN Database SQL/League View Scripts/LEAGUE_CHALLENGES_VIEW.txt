CREATE VIEW "yrden".LEAGUE_CHALLENGES AS
SELECT LCT.PUUID, YP.RIOT_ID, LCT.CHALLENGE_ID, LCV.NAME AS CHALLENGE_NAME,
LCT.PERCENTILE,
LCT.POS,
LCT.PLAYERS_IN_LEVEL,
LCT.CHALLENGE_LEVEL,
CASE 
        WHEN LCT.VALUE < LCV.IRON THEN LCV.IRON - LCT.VALUE
        WHEN LCT.VALUE < LCV.BRONZE THEN LCV.BRONZE - LCT.VALUE
        WHEN LCT.VALUE < LCV.SILVER THEN LCV.SILVER - LCT.VALUE
        WHEN LCT.VALUE < LCV.GOLD THEN LCV.GOLD - LCT.VALUE
        WHEN LCT.VALUE < LCV.PLATINUM THEN LCV.PLATINUM - LCT.VALUE
        WHEN LCT.VALUE < LCV.DIAMOND THEN LCV.DIAMOND - LCT.VALUE
        WHEN LCT.VALUE < LCV.MASTER THEN LCV.MASTER - LCT.VALUE
        WHEN LCT.VALUE < LCV.GRANDMASTER THEN LCV.GRANDMASTER - LCT.VALUE
        WHEN LCT.VALUE < LCV.CHALLENGER THEN LCV.CHALLENGER - LCT.VALUE
        ELSE 0 -- Assuming LCT.VALUE is at the highest tier or undefined tier
    END AS DifferenceToNextTier,
LCT.VALUE,
LCT.ACHIEVED_TIME,
LCV.DESCRIPTION,
LCV.IRON,
LCV.BRONZE,
LCV.SILVER,
LCV.GOLD,
LCV.PLATINUM,
LCV.DIAMOND,
LCV.MASTER,
LCV.GRANDMASTER,
LCV.CHALLENGER
FROM "yrden".LOL_CHALLENGES AS LCT
LEFT JOIN "lollov".LOL_CHALLENGES LCV
ON LCT.CHALLENGE_ID = LCV.CHALLENGE_ID
LEFT JOIN "yrden".PEOPLE YP
ON LCT.PUUID = YP.RIOT_PUUID
;